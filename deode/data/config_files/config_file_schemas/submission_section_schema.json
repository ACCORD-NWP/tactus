{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Submission Section, defined in files under include/submission",
    "description": "Defines host dependent runtime settings such as binaries, batch job rules, modules and similar",
    "type": "object",
    "additionalProperties": true,
    "properties": {
        "bindir": {
            "type": "string",
            "description": "Location of binaries"
        },
        "nproma": {
            "type": "number",
            "description": "NPROMA size in the forecast model. See the namelists for where it is used",
            "default": -32
        },
        "lfftw": {
          "type": "boolean",
          "description": "Use of the FFTW library. See the namelists for where it is used",
          "default": true
      },
        "module_initpath": {
            "type": "string",
            "description": "Path to the version of env_modules_python.py to be used in the module initialization"
        },
        "submit_types": {
            "type": "array",
            "description": "List of submit groups to be defined",
	    "items": {
              "type": "string"
            }
        },
        "default_submit_type": {
            "type": "string",
            "description": "Defines the default submit type for tasks not listed in any defined type"
        },
        "task_exceptions": {
            "type": "object",
            "description": "Allows to define task specific settings like BATCH, MODULES, NPROC. Use as task_exceptions.taskname.property"
        },
        "serial": {"$ref": "#/$submission_group" },
        "parallel": {"$ref": "#/$submission_group" },
        "background_vm": {"$ref": "#/$submission_group" },
        "background_hpc": {"$ref": "#/$submission_group" },
        "gnu": {"$ref": "#/$submission_group" }
    },
    "$submission_group": {
            "title": "Submission group",
            "description": "Defines the properties avilable for a submit group. See the existing submission files for examples",
            "type": "object",
            "properties": {
              "tasks": {
                "description": "List of tasks belonging to this group",
                "type": "array",
	        "items": {
                  "type": "string"
		}
              },
              "SCHOST": {
                "description": "Name of the host where the job runs",
                "type": "string"
              },
              "NPROC": {
                "description": "Number of processors for this task",
                "type": "number"
              },
              "WRAPPER": {
                "description": "Prefix for binaries to be executed, e.g. srun",
                "type": "string"
              },
              "BATCH": {
                "description": "Sets batch job arguments like walltime",
                "type": "object"
              },
              "ENV": {
                "description": "Sets environment variables",
                "type": "object"
              },
              "MODULES": {
                "description": "Sets modules to purge/use/unload/load or switch. To maintain the order decorate with comments to override the automatic sorting",
                "type": "object",
                "patternProperties": {
	            "^(.*)$": {
                      "type": "array",
	              "items": {
                       "type": "string"
		      },
		      "minItems": 1,
		      "maxItems": 3
		    }
		}
              }
            }
        }
}
