bindir = "/home/snh02/pack/48t3_fix.04.OMPIIFC2104.x/bin"
submit_types = ["background_vm", "background_hpc", "serial", "parallel"]
default_submit_type = "background_hpc"

[task]
wrapper = "time"

[background_vm]
INTERPRETER = "#!/usr/bin/python3"
SCHOST = "localhost"
tasks = ["Background_vm"]

[background_hpc]
SCHOST = "localhost"
tasks = ["creategrib", "Background_hpc", "UnitTest"]
wrapper = "time"

[serial]
SCHOST = "lumi-batch"
NPROC = 1
NPROCX = 1
NPROCY = 1
WRAPPER = "srun"
tasks = ["Gmted", "Soil"]

[serial.BATCH]
NAME = "#SBATCH --job-name=@TASK_NAME@"
ACCOUNT = "#SBATCH -A project_465000527"
WALLTIME = "#SBATCH --time=00:15:00"
PARTITION = "#SBATCH --partition=small"
NODES = "#SBATCH --nodes=1"
NTASKS = "#SBATCH --ntasks=1"

[serial.ENV]
AAAAOS = "import os"
AAAASYS = "import sys"
AAAMODULE_ENV = "exec(open('/usr/share/lmod/8.3.1/init/env_modules_python.py').read())"
AAMODULE_USE = "module('use', '/scratch/project_462000140/SW/modules')"
AMODULE_ECFLOW = "module('load', 'ecflow/5.9.2')"
BSYS_PATH = "sys.path.insert(0, '/scratch/project_462000140/SW/spack-setup/spack/22.08/0.18.1/ecflow-5.9.2-4eg6sen/lib/python3.9/site-packages/')"
ECF_SSL =  "os.environ['ECF_SSL'] = '1'"
DR_HOOK_SIGNALS = "os.environ['DR_HOOK_IGNORE_SIGNALS'] = '-1'"

[task_exceptions.PgdUpdate]
bindir = "/home/snh02/work/gl_binaries"
binary = "gl_20230823"

[task_exceptions.creategrib]
bindir = "/home/snh02/work/gl_binaries"
binary = "gl_20230823"

[parallel]
SCHOST = "lumi-batch"
tasks = ["Forecast", "e927", "Pgd", "Prep", "c903"]
NPROC = 32
WRAPPER = "sbatch"

[parallel.BATCH]
NAME = "#SBATCH --job-name=@TASK_NAME@"
ACCOUNT = "#SBATCH -A project_465000527"
PARTITION = "#SBATCH -p standard"
WALLTIME = "#SBATCH --time=00:10:00"

[parallel.ENV]
AAAAOS = "import os"
AAAASYS = "import sys"
AAAMODULE_ENV = "exec(open('/usr/share/lmod/8.3.1/init/env_modules_python.py').read())"
AAMODULE_USE = "module('use', '/scratch/project_462000140/SW/modules')"
AMODULE_ECFLOW = "module('load', 'ecflow/5.9.2')"
BSYS_PATH = "sys.path.insert(0, '/scratch/project_462000140/SW/spack-setup/spack/22.08/0.18.1/ecflow-5.9.2-4eg6sen/lib/python3.9/site-packages/')"
ECF_SSL =  "os.environ['ECF_SSL'] = '-1'"
OMP_NUM_THREADS= "os.environ['OMP_NUM_THREADS'] = '1'"
DR_HOOK = "os.environ['DR_HOOK'] = '1'"
DR_HOOK_SIGNALS = "os.environ['DR_HOOK_IGNORE_SIGNALS'] = '-1'"

[task_exceptions.e927]
NPROC = 16

[task_exceptions.e927.BATCH]
NODES = "#SBATCH --nodes=1"
NTASKS = "#SBATCH --ntasks=16"

[task_exceptions.Forecast]
NPROC = 1
WRAPPER = "time"

[task_exceptions.Forecast.BATCH]
NODES = "#SBATCH --nodes=1"
NTASKS = "#SBATCH --ntasks=1"
WALLTIME = "#SBATCH --time=00:30:00"

[task_exceptions.Pgd]
WRAPPER="srun -n @NPROC@"

[task_exceptions.Pgd.BATCH]
NODES = "#SBATCH --nodes=2"
NTASKS = "#SBATCH --ntasks=32"
WALLTIME = "#SBATCH --time=00:10:00"

[task_exceptions.Prep]
WRAPPER="srun -n @NPROC@"

[task_exceptions.Prep.BATCH]
NODES = "#SBATCH --nodes=1"
NTASKS = "#SBATCH --ntasks=1"
WALLTIME = "#SBATCH --time=00:10:00"

[task_exceptions.c903]
NPROC = 36

[task_exceptions.c903.BATCH]
NODE = "#SBATCH --nodes=12"
NTASKS = "#SBATCH --ntasks=36"
MEM = "#SBATCH --mem=200GB" 
WALLTIME = "#SBATCH --time=00:30:00" 

[task_exceptions.marsprep.BATCH]
NODES = "#SBATCH --nodes=1"
NTASKS = "#SBATCH --ntasks=1"
WALLTIME = "#SBATCH --time=01:00:00"
