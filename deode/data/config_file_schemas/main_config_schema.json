{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MainConfigSchema",
  "description": "Model for validation of the data in the main config file.",
  "type": "object",
  "additionalProperties": true,
  "properties": {
    "general": {
      "$ref": "#/definitions/GeneralSectionModel"
    },
    "domain": {
      "$ref": "#/definitions/Domain"
    }
  },
  "required": [
    "general"
  ],

  "definitions": {

    "Macros": {
      "title": "MacroSection",
      "description": "Model for the 'domain' section.",
      "type": "object",
      "properties": {
        "gen_macros": {
          "type": "array",
	  "description": "Turns any string config to a macro, use a dict to rename an attribute."
        },
        "os_macros": {
          "type": "array",
	  "description": "Environment variables used as macros"
        },
        "group_macros": {
          "type": "array",
	  "description": "Turns a full config section to a macro"
        }
      }
    },

    "Domain": {
      "title": "DomainSection",
      "description": "Model for the 'domain' section.",
      "type": "object",
      "properties": {
        "gridtype": {
          "type": "string",
	  "description": "Select truncation type",
	  "enum": ["linear", "quadratic", "cubic", "custom" ]
        },
        "name": {
          "type": "string",
          "description": "Name of your domain"
        },
        "nimax": {
          "type": "number",
          "description": "Number of grid points longitudinally",
	  "minimum": 0
        },
        "njmax": {
          "type": "number",
          "description": "Number of grid points latitudinally",
	  "minimum": 0
        },
        "xdx": {
          "type": "number",
          "description": "Domain longitudinal length in meters",
	  "minimum": 0
        },
        "xdy": {
          "type": "number",
          "description": "Domain latiudinal length in meters",
	  "minimum": 0
        },
        "ilone": {
          "type": "number",
          "description": "Longitudinal extension zone",
	  "minimum": 0
        },
        "ilate": {
          "type": "number",
          "description": "Latitudinal extension zone",
	  "minimum": 0
        },
        "nbzong": {
          "type": "number",
	  "minimum": 0
        },
        "nbzonl": {
          "type": "number",
	  "minimum": 0
        },
        "xloncen": {
          "type": "number",
	  "minimum": -180,
	  "maximum": 180
        },
        "xlatcen": {
          "type": "number",
	  "minimum": -90,
	  "maximum": 90
        },
        "xlon0": {
          "type": "number",
	  "minimum": -180,
	  "maximum": 180
        },
        "xlat0": {
          "type": "number",
	  "minimum": -90,
	  "maximum": 90
        }
      }
    },

    "GeneralSectionModel": {
      "title": "GeneralSectionModel",
      "description": "Model for the 'general' section.",
      "type": "object",
      "properties": {
        "times": {
          "title": "times",
          "description": "Model for the 'general.times' section.",
          "type": "object",
          "properties": {
            "start": {
              "title": "Start",
              "type": "string",
              "format": "date-time"
            },
            "end": {
              "title": "End",
              "type": "string",
              "format": "date-time"
            },
            "list": {
              "title": "List",
              "type": "array",
              "items": {
                "type": "string",
                "format": "date-time"
              }
            },
            "cycle_length": {
              "title": "Cycle Length",
              "default": "PT3H",
              "type": "string",
              "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d+[HMS])(\\d+H)?(\\d+M)?(\\d+S)?)?$"
            }
          },
          "oneOf": [
            {"required": ["start", "end"], "not": {"required": ["list"]}},
            {
              "required": ["list"],
              "not": {
                "anyOf":[
                  {"required": ["start"]},
                  {"required": ["end"]}
                ]
              }
            }
          ]
        },
        "case": {
              "title": "Experiment name",
              "default": "deode_case",
              "type": "string"
        },
        "cnmexp": {
              "title": "Experiment short name",
              "default": "DEOD",
              "type": "string",
	      "minLength" : 4,
	      "maxLength" : 4
        },
        "tstep": {
              "title": "Model time step",
              "type": "number"
        },
        "loglevel": {
              "title": "Logger info level",
              "default": "INFO",
              "type": "string",
              "enum": [ "critical", "error", "debug", "info", "warning",
                        "CRITICAL", "ERROR", "DEBUG", "INFO", "WARNING" ]
        },
        "surfex": {
              "title": "SURFEX switch",
              "type": "boolean"
        },
        "keep_workdirs": {
              "title": "Do not remove working directories",
              "type": "boolean"
        },
        "csc": {
              "title": "CSC",
              "default": "AROME",
              "type": "string",
              "enum": [ "AROME", "ALARO", "HARMONIE-AROME" ]
        },
        "cycle": {
              "title": "IAL cycle",
              "type": "string",
              "enum": [ "CY48t3", "CY46t1", "CY46h1" ]
        },
        "bdint": {
              "title": "Boundary interval",
              "type": "string",
              "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d+[HMS])(\\d+H)?(\\d+M)?(\\d+S)?)?$"
        },
        "bdcycle": {
              "title": "Boundary model cycle interval",
              "type": "string",
              "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d+[HMS])(\\d+H)?(\\d+M)?(\\d+S)?)?$"
        },
        "forecast_range": {
              "title": "Forecast range",
              "type": "string",
              "pattern": "^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d+[HMS])(\\d+H)?(\\d+M)?(\\d+S)?)?$"
        },
        "output_interval_his": {
              "description": "Output list for history files. Specified as duration for any of interval, endtime:interval, starttime:endtime:interval or a list of these options"
        },
        "output_interval_sfx": {
              "description": "Output list for history files. Specified as duration for any of interval, endtime:interval, starttime:endtime:interval or a list of these options"
        },
        "output_interval_fp": {
              "description": "Output list for history files. Specified as duration for any of interval, endtime:interval, starttime:endtime:interval or a list of these options"
        }
      },
      "required": [
        "times"
      ]
    }
  }
}
